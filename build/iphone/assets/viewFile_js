var viewFile=function(e,t,i,r){if(i)return getFileView(e,t,r);switch(e){case"image":case"img":var o,a,l=Alloy.createController("viewFile/viewFile").getView(),a=Ti.UI.createImageView({height:Ti.Platform.displayCaps.platformHeight-10,image:t,opacity:1,zIndex:1,animating:!0}),n=Ti.UI.createScrollView({width:Ti.UI.FILL,height:Ti.UI.FILL,contentWidth:Ti.UI.FILL,contentHeight:Ti.UI.FILL,maxZoomScale:4});n.add(a),l.children[1].add(n),l.open({theme:"Theme.noActionBar",transition:Titanium.UI.iPhone.AnimationStyle.CURL_UP});break;case"pdf":var o=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,r.fileName||"test.pdf");o.write(t);var s=Titanium.UI.createWebView({width:"100%",height:"100%",zIndex:1});s.setData(o.read());var d=Ti.UI.iOS.createDocumentViewer();d.setUrl(Ti.Filesystem.tempDirectory+(r.fileName||"test.pdf")),d.show();break;case"doc":var o=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,r.fileName||"test.doc");o.write(t);var d=Ti.UI.iOS.createDocumentViewer();d.setUrl(Ti.Filesystem.tempDirectory+(r.fileName||"test.doc")),d.show()}},getFileView=function(e,t,i){switch(e){case"jpg":case"png":case"jpeg":if(t.attachment)var r=t.attachment;else t.image?r=t.image:t.img&&(r=t.img);var o=Ti.UI.createImageView({image:Ti.Utils.base64decode(r)});return o.addEventListener("click",function(e){viewFile("img",e.source.image)}),o;case"pdf":var o,a=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,i.fileName||"test.pdf");a.write(Ti.Utils.base64decode(t.attachment));var l=Titanium.UI.createWebView({width:"100%",height:"100%",zIndex:1});l.setData(a.read());var n=Ti.UI.createView({width:Ti.UI.FILL,height:Ti.UI.FILL}),s=Ti.UI.createImageView({image:"/others/newOpen.png",top:"0dp",left:"0dp",width:"30dp",height:"30dp",zIndex:100,backgroundColor:"black",opacity:.7,pdf:Ti.Utils.base64decode(t.attachment)});return s.addEventListener("click",function(e){viewFile("pdf",e.source.pdf,!1,{})}),n.add(l),n.add(s),n;case"doc":var o=Ti.UI.createImageView({image:"/others/Office_DOC.png",doc:Ti.Utils.base64decode(t.attachment),width:"100%",height:"100%",focusable:!0});return o.addEventListener("click",function(e){viewFile("doc",e.source.doc,!1,{})}),o}};exports.viewFile=viewFile;