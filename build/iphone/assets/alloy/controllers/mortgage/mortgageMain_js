function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="mortgage/mortgageMain",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var e=this,t={};e.__views.morMainView=Ti.UI.createScrollView({borderColor:Alloy.Globals.showdowColor,borderRadius:8,height:Ti.UI.FILL,layout:"vertical",top:"30",backgroundGradient:Alloy.Globals.basicBackgroundColor,width:"90%",id:"morMainView"}),e.__views.morMainView&&e.addTopLevelView(e.__views.morMainView),e.__views.morTopView=Ti.UI.createView({height:Ti.UI.SIZE,id:"morTopView"}),e.__views.morMainView.add(e.__views.morTopView),e.__views.morTopSearchParaView=Ti.UI.createView({layout:"vertical",width:"50%",left:0,height:Ti.UI.SIZE,top:20,id:"morTopSearchParaView"}),e.__views.morTopView.add(e.__views.morTopSearchParaView),e.__views.__alloyId19=Ti.UI.createView({width:Ti.UI.FILL,layout:"horizontal",top:10,height:Ti.UI.SIZE,id:"__alloyId19"}),e.__views.morTopSearchParaView.add(e.__views.__alloyId19),e.__views.__alloyId20=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT,top:5,left:0,width:"40%",text:"業主叫價：",id:"__alloyId20"}),e.__views.__alloyId19.add(e.__views.__alloyId20),e.__views.price=Ti.UI.createTextField({borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,verticalAlign:Ti.UI.TEXT_VERTICAL_ALIGNMENT_TOP,font:{fontSize:14},color:"black",keyboardType:Ti.UI.KEYBOARD_NUMBER_PAD,top:0,left:0,width:"55%",value:"2000000",id:"price"}),e.__views.__alloyId19.add(e.__views.price),e.__views.__alloyId21=Ti.UI.createView({width:Ti.UI.FILL,layout:"horizontal",top:10,height:Ti.UI.SIZE,id:"__alloyId21"}),e.__views.morTopSearchParaView.add(e.__views.__alloyId21),e.__views.__alloyId22=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT,top:5,left:0,width:"40%",text:"按揭比率(%)：",id:"__alloyId22"}),e.__views.__alloyId21.add(e.__views.__alloyId22),e.__views.percent=Ti.UI.createTextField({borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,verticalAlign:Ti.UI.TEXT_VERTICAL_ALIGNMENT_TOP,font:{fontSize:14},color:"black",keyboardType:Ti.UI.KEYBOARD_NUMBER_PAD,top:0,left:0,width:"55%",value:"70",id:"percent"}),e.__views.__alloyId21.add(e.__views.percent),e.__views.__alloyId23=Ti.UI.createView({width:Ti.UI.FILL,layout:"horizontal",top:10,height:Ti.UI.SIZE,id:"__alloyId23"}),e.__views.morTopSearchParaView.add(e.__views.__alloyId23),e.__views.__alloyId24=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT,top:5,left:0,width:"40%",text:"利率(%)：",id:"__alloyId24"}),e.__views.__alloyId23.add(e.__views.__alloyId24),e.__views.rate=Ti.UI.createTextField({borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,verticalAlign:Ti.UI.TEXT_VERTICAL_ALIGNMENT_TOP,font:{fontSize:14},color:"black",keyboardType:Ti.UI.KEYBOARD_NUMBER_PAD,top:0,left:0,width:"55%",value:"2.25",id:"rate"}),e.__views.__alloyId23.add(e.__views.rate),e.__views.__alloyId25=Ti.UI.createView({width:Ti.UI.FILL,layout:"horizontal",top:10,height:Ti.UI.SIZE,id:"__alloyId25"}),e.__views.morTopSearchParaView.add(e.__views.__alloyId25),e.__views.__alloyId26=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT,top:5,left:0,width:"40%",text:"按揭年期：",id:"__alloyId26"}),e.__views.__alloyId25.add(e.__views.__alloyId26),e.__views.period=Ti.UI.createTextField({borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,verticalAlign:Ti.UI.TEXT_VERTICAL_ALIGNMENT_TOP,font:{fontSize:14},color:"black",keyboardType:Ti.UI.KEYBOARD_NUMBER_PAD,top:0,left:0,width:"55%",value:"20",id:"period"}),e.__views.__alloyId25.add(e.__views.period),e.__views.__alloyId27=Ti.UI.createView({width:Ti.UI.FILL,layout:"horizontal",top:10,height:Ti.UI.SIZE,id:"__alloyId27"}),e.__views.morTopSearchParaView.add(e.__views.__alloyId27),e.__views.__alloyId28=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT,top:5,left:0,width:"40%",text:"貸款金額：",id:"__alloyId28"}),e.__views.__alloyId27.add(e.__views.__alloyId28),e.__views.principal=Ti.UI.createTextField({borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,verticalAlign:Ti.UI.TEXT_VERTICAL_ALIGNMENT_TOP,font:{fontSize:14},color:"black",keyboardType:Ti.UI.KEYBOARD_NUMBER_PAD,top:0,left:0,width:"55%",id:"principal",editable:"false"}),e.__views.__alloyId27.add(e.__views.principal),e.__views.morTopSmlResView=Ti.UI.createView({width:"50%",height:Ti.UI.SIZE,left:"50%",top:20,layout:"vertical",id:"morTopSmlResView"}),e.__views.morTopView.add(e.__views.morTopSmlResView),e.__views.__alloyId29=Ti.UI.createView({width:Ti.UI.FILL,layout:"horizontal",left:10,top:15,height:Ti.UI.SIZE,id:"__alloyId29"}),e.__views.morTopSmlResView.add(e.__views.__alloyId29),e.__views.__alloyId30=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT,top:10,left:0,width:"30%",text:"首期：",id:"__alloyId30"}),e.__views.__alloyId29.add(e.__views.__alloyId30),e.__views.Deposit=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_LEFT,top:10,left:0,width:"60%",id:"Deposit"}),e.__views.__alloyId29.add(e.__views.Deposit),e.__views.__alloyId31=Ti.UI.createView({width:Ti.UI.FILL,layout:"horizontal",left:10,top:15,height:Ti.UI.SIZE,id:"__alloyId31"}),e.__views.morTopSmlResView.add(e.__views.__alloyId31),e.__views.__alloyId32=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT,top:10,left:0,width:"30%",text:"每用供款：",id:"__alloyId32"}),e.__views.__alloyId31.add(e.__views.__alloyId32),e.__views.MonthlyPayment=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_LEFT,top:10,left:0,width:"60%",id:"MonthlyPayment"}),e.__views.__alloyId31.add(e.__views.MonthlyPayment),e.__views.__alloyId33=Ti.UI.createView({width:Ti.UI.FILL,layout:"horizontal",left:10,top:15,height:Ti.UI.SIZE,id:"__alloyId33"}),e.__views.morTopSmlResView.add(e.__views.__alloyId33),e.__views.__alloyId34=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT,top:10,left:0,width:"30%",text:"總利息：",id:"__alloyId34"}),e.__views.__alloyId33.add(e.__views.__alloyId34),e.__views.TotalInterest=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_LEFT,top:10,left:0,width:"60%",id:"TotalInterest"}),e.__views.__alloyId33.add(e.__views.TotalInterest),e.__views.__alloyId35=Ti.UI.createView({width:Ti.UI.FILL,layout:"horizontal",left:10,top:15,height:Ti.UI.SIZE,id:"__alloyId35"}),e.__views.morTopSmlResView.add(e.__views.__alloyId35),e.__views.__alloyId36=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_RIGHT,top:10,left:0,width:"30%",text:"總貸款金額：",id:"__alloyId36"}),e.__views.__alloyId35.add(e.__views.__alloyId36),e.__views.TotalPayment=Ti.UI.createLabel({color:"black",textAlign:Titanium.UI.TEXT_ALIGNMENT_LEFT,top:10,left:0,width:"60%",id:"TotalPayment"}),e.__views.__alloyId35.add(e.__views.TotalPayment),e.__views.__alloyId37=Ti.UI.createView({width:Ti.UI.FILL,layout:"horizontal",left:10,top:15,height:Ti.UI.SIZE,id:"__alloyId37"}),e.__views.morTopSmlResView.add(e.__views.__alloyId37),e.__views.morTopSmlResCal=Ti.UI.createButton({backgroundImage:"/others/Calculate.png",width:"120",height:"30",top:10,left:0,id:"morTopSmlResCal"}),e.__views.__alloyId37.add(e.__views.morTopSmlResCal),e.__views.morScroll=Ti.UI.createScrollView({top:10,width:"80%",height:Ti.UI.FILL,contentWidth:"auto",scrollType:"horizontal",borderRadius:5,id:"morScroll"}),e.__views.morMainView.add(e.__views.morScroll),e.__views.morResHeader=Ti.UI.createView({layout:"horizontal",height:Ti.UI.SIZE,backgroundGradient:{type:"linear",colors:[{color:"#23aa90",offset:0},{color:"#21a088",offset:.45},{color:"#1b846f",offset:1}]},color:"#FFFFFF",id:"morResHeader"}),e.__views.morReslist=Ti.UI.createTableView({headerView:e.__views.morResHeader,id:"morReslist"}),e.__views.morScroll.add(e.__views.morReslist),t.destroy=function(){},_.extend(e,e.__views);var i=require("mortgage"),o=arguments[0]||{};o.win;var r={init:function(){this.setEvent(),this.calPrincipal()},setEvent:function(){e.price.addEventListener("change",r.calPrincipal),e.percent.addEventListener("change",r.calPrincipal),e.morTopSmlResCal.addEventListener("click",function(){var t=e.percent.value,o=e.rate.value,r=e.period.value,l=e.price.value;if(!(isNaN(t)||isNaN(o)||isNaN(r)||isNaN(l))){var n=new i(l,r,o,t);e.TotalPayment.text=n.getTotalPayment(),e.MonthlyPayment.text=n.getMonthlyPayment(),e.TotalInterest.text=n.getTotalInterest(),e.Deposit.text=n.getDeposit();var s=n.getPeriodList(),d=n.getPaymentList();a.genResultTableHeader(s),a.genMorFullList(d,n.getPeriod(),n.getRate())}})},calPrincipal:function(){isNaN(e.price.value)||isNaN(e.percent.value)||(e.principal.value=comjs.addCommas(e.price.value*e.percent.value/100))}},a={genResultTableHeader:function(t){for(o=e.morResHeader.children.length;o>0;o--)e.morResHeader.remove(e.morResHeader.children[o-1]);var i=Ti.UI.createLabel({textAlign:Titanium.UI.TEXT_ALIGNMENT_CENTER,color:"black",text:"利率",width:"80"});e.morResHeader.add(i);var o=0;for(var r in t)o++,e.morResHeader.add(Ti.UI.createLabel({textAlign:Titanium.UI.TEXT_ALIGNMENT_CENTER,color:"black",text:t[r]+"年",width:"130",height:40}));e.morReslist.setWidth(100+130*o)},genMorFullList:function(t,i,o){var r=[];for(var a in t){var l=Ti.UI.createTableViewRow(),n=Ti.UI.createView({layout:"horizontal",color:"black",height:40}),s=a/100==o?"#086A87":"#000000",d=Ti.UI.createLabel({textAlign:Titanium.UI.TEXT_ALIGNMENT_CENTER,color:s,text:a/100,width:"80"});n.add(d);for(var _ in t[a]){var s=_==i||a/100==o?"#086A87":"#000000",c=comjs.morAddCommas(t[a][_]);n.add(Ti.UI.createLabel({textAlign:Titanium.UI.TEXT_ALIGNMENT_CENTER,color:s,text:c,width:"130"}))}l.add(n),r.push(l)}e.morReslist.data=r}};r.init(),_.extend(e,t)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;