function __processArg(e,t){var i=null;return e&&(i=e[t]||null,delete e[t]),i}function Controller(){function t(e,t,i){switch(e){case"est":case"estate":switch(t){case 1:i.backgroundGradient=c.estNonActColor,i.image="",i.active=0;break;case 0:i.backgroundGradient=c.estActColor,i.image="/temp/tick.png",i.active=1}break;case"dist":case"district":switch(t){case 1:i.backgroundGradient=c.distNonActColor,i.image="",i.active=0;break;case 0:i.backgroundGradient=c.distActColor,i.image="/temp/tick.png",i.active=1}}}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="trans/transMainLayout",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var i=this,o={};i.__views.transMainLayout=Ti.UI.createView({left:"0dp",height:Ti.UI.FILL,id:"transMainLayout"}),i.__views.transMainLayout&&i.addTopLevelView(i.__views.transMainLayout),i.__views.tranResMain=Ti.UI.createView({layout:"vertical",id:"tranResMain"}),i.__views.transMainLayout.add(i.__views.tranResMain),i.__views.tranResBtn=Ti.UI.createView({width:"100%",height:Ti.UI.SIZE,zIndex:100,left:20,top:0,id:"tranResBtn"}),i.__views.tranResMain.add(i.__views.tranResBtn),i.__views.tranResDistBtn=Ti.UI.createView({top:0,width:"100%",height:Ti.UI.SIZE,layout:"horizontal",id:"tranResDistBtn"}),i.__views.tranResBtn.add(i.__views.tranResDistBtn),i.__views.tranResEstBtn=Ti.UI.createView({top:40,width:"100%",height:Ti.UI.SIZE,layout:"horizontal",id:"tranResEstBtn",visible:"false"}),i.__views.tranResBtn.add(i.__views.tranResEstBtn),i.__views.tranRes=Ti.UI.createView({layout:"horizontal",width:"90%",top:10,id:"tranRes"}),i.__views.tranResMain.add(i.__views.tranRes),i.__views.tranScroll=Ti.UI.createScrollView({top:0,width:"100%",height:Ti.UI.FILL,contentWidth:"auto",scrollType:"horizontal",borderRadius:5,id:"tranScroll"}),i.__views.tranRes.add(i.__views.tranScroll),i.__views.tranResHeader=Ti.UI.createView({layout:"horizontal",height:50,backgroundGradient:{type:"linear",colors:[{color:"#23aa90",offset:0},{color:"#21a088",offset:.45},{color:"#1b846f",offset:1}]},color:"#FFFFFF",id:"tranResHeader"}),i.__views.unit=Ti.UI.createLabel({color:"#ffffff",text:"單位",id:"unit",width:"110",left:"15",top:"5"}),i.__views.tranResHeader.add(i.__views.unit),i.__views.floor=Ti.UI.createLabel({color:"#ffffff",text:"樓層",id:"floor",width:"60",top:"5"}),i.__views.tranResHeader.add(i.__views.floor),i.__views.garea=Ti.UI.createLabel({color:"#ffffff",text:"建築\n面積",id:"garea",width:"65",top:"5"}),i.__views.tranResHeader.add(i.__views.garea),i.__views.narea=Ti.UI.createLabel({color:"#ffffff",text:"實用\n面積",id:"narea",width:"65",top:"5"}),i.__views.tranResHeader.add(i.__views.narea),i.__views.price=Ti.UI.createLabel({color:"#ffffff",text:"成交價",id:"price",width:"120",top:"5"}),i.__views.tranResHeader.add(i.__views.price),i.__views.avaprice=Ti.UI.createLabel({color:"#ffffff",text:"建築\n呎價",id:"avaprice",width:"65",top:"5"}),i.__views.tranResHeader.add(i.__views.avaprice),i.__views.avnprice=Ti.UI.createLabel({color:"#ffffff",text:"實用\n呎價",id:"avnprice",width:"65",top:"5"}),i.__views.tranResHeader.add(i.__views.avnprice),i.__views.date=Ti.UI.createLabel({color:"#ffffff",text:"成交\n日期",id:"date",width:"100",top:"5"}),i.__views.tranResHeader.add(i.__views.date),i.__views.usage=Ti.UI.createLabel({color:"#ffffff",text:"類別",id:"usage",width:"65",top:"5"}),i.__views.tranResHeader.add(i.__views.usage),i.__views.source=Ti.UI.createLabel({color:"#ffffff",text:"資料\n來源",id:"source",width:"80",top:"5"}),i.__views.tranResHeader.add(i.__views.source);var r=[];i.__views.__alloyId107=Ti.UI.createTableViewRow({id:"__alloyId107"}),r.push(i.__views.__alloyId107),i.__views.transItem=Ti.UI.createView({layout:"horizontal",height:45,color:"#676767",backgroundSelectedColor:"#f4f4f4",id:"transItem"}),i.__views.__alloyId107.add(i.__views.transItem),i.__views.__alloyId108=Ti.UI.createLabel({color:"black",text:"單位",id:"__alloyId108",width:"110",left:"15",top:"10"}),i.__views.transItem.add(i.__views.__alloyId108),i.__views.__alloyId109=Ti.UI.createLabel({color:"black",text:"高",id:"__alloyId109",width:"60",top:"10"}),i.__views.transItem.add(i.__views.__alloyId109),i.__views.__alloyId110=Ti.UI.createLabel({color:"black",text:"6000",id:"__alloyId110",width:"65",top:"10"}),i.__views.transItem.add(i.__views.__alloyId110),i.__views.__alloyId111=Ti.UI.createLabel({color:"black",text:"5000",id:"__alloyId111",width:"65",top:"10"}),i.__views.transItem.add(i.__views.__alloyId111),i.__views.__alloyId112=Ti.UI.createLabel({color:"black",text:"10,252,123",id:"__alloyId112",width:"120",top:"10"}),i.__views.transItem.add(i.__views.__alloyId112),i.__views.__alloyId113=Ti.UI.createLabel({color:"black",text:"1000",id:"__alloyId113",width:"65",top:"10"}),i.__views.transItem.add(i.__views.__alloyId113),i.__views.__alloyId114=Ti.UI.createLabel({color:"black",text:"1000",id:"__alloyId114",width:"65",top:"10"}),i.__views.transItem.add(i.__views.__alloyId114),i.__views.__alloyId115=Ti.UI.createLabel({color:"black",text:"2014/03/02",id:"__alloyId115",width:"100",top:"10"}),i.__views.transItem.add(i.__views.__alloyId115),i.__views.__alloyId116=Ti.UI.createLabel({color:"black",text:"工業",id:"__alloyId116",width:"65",top:"10"}),i.__views.transItem.add(i.__views.__alloyId116),i.__views.__alloyId117=Ti.UI.createLabel({color:"black",text:"田土廳",id:"__alloyId117",width:"80",top:"10"}),i.__views.transItem.add(i.__views.__alloyId117),i.__views.tranReslist=Ti.UI.createTableView({top:0,width:"100%",borderWidth:1,borderColor:Alloy.Globals.showdowColor,zIndex:1,borderRadius:5,data:r,headerView:i.__views.tranResHeader,id:"tranReslist"}),i.__views.tranScroll.add(i.__views.tranReslist),o.destroy=function(){},_.extend(i,i.__views),loginInfo=Ti.App.Properties.getObject("loginInfo",!1);var a=require("getData").trans,l=[],n={},s=[],d=arguments[0]||{};d.win;var c={distNonActColor:{type:"linear",colors:[{color:"#4DB2B6",offset:0},{color:"#409295",offset:1}]},estNonActColor:{type:"linear",colors:[{color:"#C8C8C8",offset:0},{color:"#919191",offset:1}]},distActColor:{type:"linear",colors:[{color:"#295E61",offset:0},{color:"#214D4F",offset:1}]},estActColor:{type:"linear",colors:[{color:"#646464",offset:0},{color:"#4D4D4D",offset:1}]},tableField:{flat:{width:"110dp",left:"15dp",top:"10dp"},floor:{width:"60dp",top:"10dp"},grossarea:{width:"65dp",top:"10dp",datatype:"number"},netarea:{width:"65dp",top:"10dp",datatype:"number"},consideration:{width:"120dp",top:"10dp",datatype:"number"},averageprice:{width:"65dp",top:"10dp",datatype:"number"},netaverage:{width:"65dp",top:"10dp",datatype:"number"},transacdate:{width:"100dp",top:"10dp"},stage:{width:"65dp",top:"10dp"},infosource:{width:"80dp",top:"10dp"}},init:function(){this.showTransData(),this.showDistEst()},showTransData:function(e){var t={c_district:this.getNonSelect("dist"),c_estate:this.getNonSelect("est")},e=[],o=a.getList(t);for(var r in o){var l=Ti.UI.createView({layout:"horizontal",height:45,color:"#676767",backgroundSelectedColor:"#f4f4f4"});for(var n in this.tableField){var s=Ti.UI.createLabel({text:o[r][n.toLowerCase()]||"",color:"black",width:this.tableField[n].width,top:this.tableField[n].top,left:this.tableField[n].left});switch(this.tableField[n].datatype){case"number":s.text=comjs.addCommas(o[r][n.toLowerCase()])}l.add(s)}var d=Ti.UI.createTableViewRow();d.add(l),e.push(d)}i.tranReslist.data=e},showDistEst:function(){var e=a.getDistEst(),o=[],r={};for(var s in e){var d=e[s].c_district,_=e[s].c_estate;if(-1==o.indexOf(d)){o.push(d),r[d]=[],r[d].push(_);var p=Ti.UI.createButton({title:d,width:95,height:35,top:5,left:5,active:0,right:"10dp",dist:d,font:{},color:"#FFFFFF",borderRadius:5,backgroundGradient:this.distNonActColor});l.push(p),i.tranResDistBtn.add(p);var w=Ti.UI.createButton({title:_,dist:d,est:_,width:95,height:35,top:5,left:5,active:0,right:"10dp",font:{},color:"#FFFFFF",borderRadius:5,backgroundGradient:this.estNonActColor});n[d]=[],n[d].push(w),i.tranResEstBtn.add(w),p.addEventListener("click",function(e){if(e.source.active){t("dist",e.source.active,e.source);for(var i in n[e.source.dist])t("est",1,n[e.source.dist][i])}else{t("dist",e.source.active,e.source);for(var i in n[e.source.dist])t("est",0,n[e.source.dist][i])}c.showTransData()})}else{r[d].push(_);var w=Ti.UI.createButton({title:_,dist:d,est:_,active:0,width:114,height:40,top:10,right:"10dp",font:{fontSize:"15dp"},color:"#FFFFFF",borderRadius:5,backgroundGradient:this.estActColor});n[d].push(w),i.tranResEstBtn.add(w)}w.addEventListener("click",function(e){if(e.source.active)t("est",e.source.active,e.source);else{t("est",e.source.active,e.source);for(var i in l)e.source.dist==l[i].title&&t("dist",0,l[i])}c.showTransData()})}},getNonSelect:function(t){switch(t){case"district":case"dist":s=[];var i=[];for(var o in l)0==l[o].active&&i.push(l[o].dist);return i.length>0?(s=i,"'"+i.join("','")+"'"):"";case"est":case"estate":var i=[];for(var o in n)if(-1==_.indexOf(s,o)||0==s.length)for(e in n[o])0==n[o][e].active&&i.push(n[o][e].est);return i.length>0?"'"+i.join("','")+"'":"";default:return""}}};c.init(),_.extend(i,o)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;